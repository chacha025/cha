<button id="capture">撮影</button>
<a id="downloadLink" style="display: none" download="captured-image.png">画像をダウンロード</a>
<canvas id="canvas" style="display: none"></canvas>

<script>
navigator.mediaDevices
  .getUserMedia({ video: true })
  .then((stream) => {
    const video = document.getElementById("video");
    video.srcObject = stream;
  })
  .catch((error) => {
    console.error("カメラにアクセスできませんでした:", error);
  });

document.getElementById("capture").addEventListener("click", () => {
  const canvas = document.getElementById("canvas");
  const video = document.getElementById("video");
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  const context = canvas.getContext("2d");
  context.drawImage(video, 0, 0, canvas.width, canvas.height);
  
  const dataURL = canvas.toDataURL("image/png");
  console.log("キャプチャした画像のデータURL:", dataURL);

  // ダウンロードリンクを設定してクリックする
  const downloadLink = document.getElementById("downloadLink");
  downloadLink.href = dataURL;
  downloadLink.click();
});
</script>
